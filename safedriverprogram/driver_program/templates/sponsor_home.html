{% extends 'base.html' %}

{% block title %}Sponsor Dashboard - Safe Driver Program{% endblock %}

{% block content %}
<div class="container">
  <div class="box">
    <h1 class="title has-text-centered">
      <span class="icon is-large has-text-primary">
        <i class="fas fa-tachometer-alt fa-2x"></i>
      </span>
      <br>
      Sponsor Dashboard
    </h1>
    
    <h2 class="subtitle has-text-centered">
      Welcome back, {{ sponsor_info.first_name }}!
    </h2>
    
    <!-- Statistics Cards -->
    <div class="columns">
      <div class="column">
        <div class="box has-background-success-light">
          <div class="level">
            <div class="level-item has-text-centered">
              <div>
                <p class="heading">Active Drivers</p>
                <p class="title">{{ active_drivers_count }}</p>
            <!-- Bulk Upload Section -->
            <div class="container" style="margin-top: 1.5rem;">
              <div class="box">
                <h2 class="title is-4">Bulk Upload Users</h2>
                <p class="content">Upload a pipe-delimited file to add Drivers (D) and Sponsors (S) to your organization.</p>

                <div class="notification is-light">
                  <p class="mb-2"><strong>Format:</strong> &lt;user type&gt; || First Name | Last Name | email</p>
                  <pre class="has-background-light p-3" style="white-space: pre-wrap;">
            D || Joe | Driver | joe@example.com
            S || Jill | Sponsor | jill@example.com
                  </pre>
                </div>

                <form method="post" action="{% url 'bulk_sponsor_upload' %}" enctype="multipart/form-data">
                  {% csrf_token %}
                  <div class="field is-grouped is-align-items-center">
                    <div class="control">
                      <div class="file has-name is-small">
                        <label class="file-label">
                          <input class="file-input" type="file" name="upload_file" accept=".txt,.csv,.dat">
                          <span class="file-cta">
                            <span class="file-icon">
                              <i class="fas fa-upload"></i>
                            </span>
                            <span class="file-label">
                              Choose a fileâ€¦
                            </span>
                          </span>
                        </label>
                      </div>
                    </div>
                    <div class="control">
                      <button type="submit" class="button is-primary is-small">
                        Upload
                      </button>
                    </div>
                  </div>
                </form>
              </div>
            </div>

              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="column">
        <div class="box has-background-warning-light">
          <div class="level">
            <div class="level-item has-text-centered">
              <div>
                <p class="heading">Pending Applications</p>
                <p class="title">{{ pending_applications }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="field is-grouped is-grouped-multiline is-justify-content-center">
      <div class="control">
        <a href="{% url 'sponsor_drivers' %}" class="button is-primary is-large">
          <span class="icon">
            <i class="fas fa-users"></i>
          </span>
          <span>Manage Drivers</span>
        </a>
      </div>

      <div class="control">
        <a href="{% url 'sponsor_wallet_history' %}" class="button is-success is-large">
          <span class="icon">
            <i class="fas fa-wallet"></i>
          </span>
          <span>Wallet History</span>
        </a>
      </div>

      <div class="control">
        <a href="{% url 'sponsor_profile' %}" class="button is-info is-large">
          <span class="icon">
            <i class="fas fa-user-edit"></i>
          </span>
          <span>Edit Profile</span>
        </a>
      </div>

      <div class="control">
        <a href="{% url 'sponsor_adjust_point_exchange_rate' %}" class="button is-link is-large">
          <span class="icon">
            <i class="fas fa-exchange-alt"></i>
          </span>
          <span>Edit Exchange Rate</span>
        </a>
      </div>

      <div class="control">
        <a href="{% url 'sponsor_adjust_catalogue' %}" class="button is-light is-medium">
          <span class="icon">
            <i class="fas fa-th-list"></i>
          </span>
          <span>Adjust Catalogue</span>
        </a>
      </div>

      <div class="control">
        <a href="{% url 'generate_driver_point_report' %}" class="button is-warning is-large">
          <span class="icon">
            <i class="fas fa-chart-line"></i>
          </span>
          <span>Generate Driver Point History Report by Date Range</span>
        </a>
      </div>
    </div>

  </div>
</div>
{% endblock %}
